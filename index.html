<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2566">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="ru"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1">&lt;title&gt;Генератор идей&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">&lt;style&gt;</span></p>
<p class="p1"><span class="s1">* { box-sizing: border-box; }</span></p>
<p class="p1"><span class="s1">body { margin: 0; padding: 20px; font-family: 'Helvetica Neue', Arial, sans-serif; background: #fff; }</span></p>
<p class="p1"><span class="s1">&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="chat-widget" style="max-width: 600px; margin: 0 auto;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div style="background: #000; color: #fff; padding: 20px; border-radius: 8px 8px 0 0;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h3 style="margin: 0; font-size: 18px; font-weight: 500;"&gt;Генератор идей&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div id="chat-messages" style="background: #f7f7f7; height: 400px; overflow-y: auto; padding: 20px; border: 1px solid #e0e0e0;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div style="margin-bottom: 15px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div style="background: #fff; padding: 12px 16px; border-radius: 8px; display: inline-block; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Привет. Я - генератор идей. Начнем</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div style="background: #fff; padding: 15px; border-radius: 0 0 8px 8px; border: 1px solid #e0e0e0; border-top: none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div style="display: flex; gap: 10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;input type="text" id="chat-input" placeholder="Напишите ответ..." style="flex: 1; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; outline: none;" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;button id="chat-send" style="background: #000; color: #fff; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;"&gt;Отправить&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div id="typing-indicator" style="display: none; padding: 10px 20px; font-size: 12px; color: #999;"&gt;Генератор думает...&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">(function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const API_URL = 'https://plainfrog-5107.torbichev.workers.dev';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>let sessionId = localStorage.getItem('chat_session_id');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (!sessionId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>localStorage.setItem('chat_session_id', sessionId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const chatHistory = JSON.parse(localStorage.getItem('chat_history') || '[]');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const messagesContainer = document.getElementById('chat-messages');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const input = document.getElementById('chat-input');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const sendBtn = document.getElementById('chat-send');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const typingIndicator = document.getElementById('typing-indicator');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (chatHistory.length &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messagesContainer.innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>chatHistory.forEach(msg =&gt; addMessage(msg.text, msg.isUser, false));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function addMessage(text, isUser, saveToHistory) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const messageDiv = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messageDiv.style.marginBottom = '15px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messageDiv.style.textAlign = isUser ? 'right' : 'left';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const bubble = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.background = isUser ? '#000' : '#fff';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.color = isUser ? '#fff' : '#000';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.padding = '12px 16px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.borderRadius = '8px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.display = 'inline-block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.maxWidth = '80%';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.boxShadow = '0 1px 2px rgba(0,0,0,0.1)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.wordWrap = 'break-word';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.style.whiteSpace = 'pre-wrap';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bubble.textContent = text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messageDiv.appendChild(bubble);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messagesContainer.appendChild(messageDiv);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>messagesContainer.scrollTop = messagesContainer.scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (saveToHistory) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>chatHistory.push({ text, isUser });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>localStorage.setItem('chat_history', JSON.stringify(chatHistory));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>async function sendMessage() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const message = input.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!message) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addMessage(message, true, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>input.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>typingIndicator.style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sendBtn.disabled = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>input.disabled = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const response = await fetch(API_URL, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>headers: { 'Content-Type': 'application/json' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body: JSON.stringify({ chatInput: message, sessionId: sessionId })</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!response.ok) throw new Error('HTTP ' + response.status);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const data = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>typingIndicator.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const botResponse = data.response || data.output || 'Ошибка получения ответа';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>addMessage(botResponse, false, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (data.isComplete &amp;&amp; data.ideas) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setTimeout(() =&gt; displayIdeas(data.ideas), 500);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>console.error('Ошибка:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>typingIndicator.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>addMessage('Произошла ошибка соединения.', false, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>sendBtn.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>input.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>input.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function displayIdeas(ideas) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text = '🎯 Ваши ТОП-10 идей:\n\n';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (Array.isArray(ideas)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>ideas.forEach((idea, i) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>text += `${i+1}. ${idea.name}\n${idea.description}\n💰 ${idea.monthly_revenue_potential}₽/мес | ⏱ ${idea.estimated_hours}ч\n\n`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addMessage(text, false, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>sendBtn.addEventListener('click', sendMessage);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>input.addEventListener('keypress', (e) =&gt; { if (e.key === 'Enter') sendMessage(); });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>input.focus();</span></p>
<p class="p1"><span class="s1">})();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
